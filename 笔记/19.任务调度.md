```
crontab 选项
```

|         符号          |             说明              |
| :-------------------: | :---------------------------: |
|          -e           |      编辑crontab定时任务      |
|          -l           |        查询crontab任务        |
|          -r           | 删除当前用户所有的crontab任务 |
| service crond restart |         重启任务调度          |

```
我们现在想做的是
每分钟往tmp/to.txt中写入/etc文件夹下的所有文件
*/1 * * * * ls -l /etc > /tmp/to.txt
```

|  项目   |         含义         |        范围         |
| :-----: | :------------------: | :-----------------: |
| 第一个* | 一小时当中的第几分钟 |        0-59         |
| 第二个* |  一天当中的第几小时  |        0-23         |
| 第三个* |  一个月当中的第几天  |        1-31         |
| 第四个* |  一年当中的第几个月  |        1-12         |
| 第五个* |    一周当中的周几    | 0-7【0和7都是周末】 |

| 特殊符号 |                        含义                         |
| :------: | :-------------------------------------------------: |
|    *     |                    代表任何时间                     |
|    ,     | 比如0 8,12,16 * * * 代表每天的8点，12点，16点整执行 |
|    -     |       0 5 * * 1-6 代表每周一到周六 5点整执行        |
|   */n    |         */10 * * * * 代表每隔10分钟执行一次         |

```
每隔1分钟，就将当前的时间信息追加到tmp/mydate文件中
*/1 * * * * date >> /tmp/mydate
```

```
每隔1分钟，就将日期和日历都追加到/home/mycal中

我们先写一个脚本，在home下创建一个my.sh
date >> /tmp/mycal
cal >> /tmp/mycal
然后去调用这个脚本就行了
*/1 * * * * /home/my.sh

```

```
每天凌晨2点吧mysql数据库testdb，备份到文件中
0 2 * * * mysqldump -u root -p 123456 testdb >> /home/db.bak
```





### 一次性定时任务

在后台会有一个进程每隔60秒检查一次，是否有一次性定时任务需要执行

```
ps -ef 检测所有进程
ps -ef | grep atd 
```

```
at 选项 时间
Ctrl + D 结束at命令的输入【要输入2次】
```

```
查询队列有哪些定时任务
atq
```

```
删除任务
atrm 编号
```



|     选项     |                            含义                            |
| :----------: | :--------------------------------------------------------: |
|      -m      | 当指定的任务被完成后，将会给用户发送邮件，即使没有标准输出 |
|      -I      |                         atq的别名                          |
|      -d      |                         atrm的别名                         |
|      -v      |                   显示任务将被执行的时间                   |
|      -c      |                  打印任务的内容到标准输出                  |
|      -V      |                        显示版本信息                        |
|   -q<队列>   |                       使用指定的队列                       |
|   -f<文件>   |           从指定文件读入任务而不是从标准输入读入           |
| -t<时间参数> |              以时间参数的形式提交要运行的任务              |

![image-20221202152817546](image/19.%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/image-20221202152817546.png)



```
2天后的下午5点执行 /bin/ls /home
at 5pm + 2days
/bin/ls /home
```

```
明天17点，输出时间到指定文件 /root/date100.log
at 5pm tomorrow
date > /root/date100.log
```

```
2分钟后，输出时间到指定文件 /root/date200.log
at now + 2 minutes
date > /root/date200.log
```

```
删除任务为1的任务
atrm 1
```

